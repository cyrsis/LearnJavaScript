<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>

<body>
<table id="table1" width="14%" cellpadding="1"  bordercolor="#000000" bgcolor="#000000">   
      <tr bgcolor="#FFFFFF">     
          <td   width="40%">A</td>   
          <td   width="60%">1</td>   
      </tr>   
      <tr bgcolor="#FFFFFF">     
          <td   width="40%">A</td>   
          <td   width="60%">2</td>   
      </tr>   
      <tr bgcolor="#FFFFFF">     
          <td   width="40%">B</td>   
          <td   width="60%">1</td>   
      </tr>   
      <tr bgcolor="#FFFFFF">     
          <td   width="40%">B</td>   
          <td   width="60%">2</td>   
      </tr>   
      <tr bgcolor="#FFFFFF">     
          <td   width="40%">B</td>   
          <td   width="60%">3</td>   
      </tr>   
      <tr bgcolor="#FFFFFF">     
          <td   width="40%">A</td>   
          <td   width="60%">1</td>   
      </tr>   
</table>
<p></p>
<input type="button" value="合並單元格" onclick="merge()">   
<script language="javascript">   
function merge(){   
	var rows=table1.rows;   
	var nrow=0,nlastrow;   
	var ncol=0; 
	while(nrow<rows.length){   
		nlastrow=nrow++;   
		while(nrow<rows.length && rows[nlastrow].cells[ncol].innerText==rows[nrow].cells[ncol].innerText)   
			nrow++;   
		if(nrow-nlastrow>1){   
			for(var i=nlastrow+1;i<nrow;i++){rows[i].deleteCell(ncol);}   
			rows[nlastrow].cells[ncol].rowSpan=nrow-nlastrow;   
		}   
	}   
}   
</script>
</body>
</html>
